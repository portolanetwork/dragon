syntax = "proto3";

package dragon.turnstile.v1;

option java_multiple_files = true;
option java_package = "dragon.turnstile.api.v1";
option java_outer_classname = "TurnstileProto";

import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/struct.proto";
//import "dragon/common/v1/objects.proto";


option go_package = "dragon/turnstile/api/v1";



service TurnstileService {
    rpc ListMcpServers (ListMcpServersRequest)  returns (McpServerList) {}
    rpc CreateMcpServer (CreateMcpServerRequest) returns (McpServer) {}
    rpc DeleteMcpServer (DeleteMcpServerRequest) returns (google.protobuf.Empty) {}

    //rpc GetLoginStatusForMcpServer (GetLoginStatusForMcpServerRequest) returns (McpServerLoginStatus) {}
    rpc LoginToMcpServer (LoginMcpServerRequest) returns (McpServerLoginUrl) {}
}

// MCP Servers
message CreateMcpServerRequest {
    string name = 1;
    string url = 2;
    string auth_type = 3; // Authentication type: none, discover, or static_auth_header
    string static_token = 4; // Static authentication token (optional, used with static_auth_header)
}

message ListMcpServersRequest {
    string user_id = 1;
    //string page_size = 2;
    //string page_token = 3;
}

message DeleteMcpServerRequest {
    string uuid = 1;
}

message McpServerList {
    repeated McpServer mcp_server = 1;
}

message McpServer {
    string uuid = 1;
    string name = 2;
    string url = 3;
    string auth_type = 4; // Authentication type: none, discover, or static_auth_header
    bool has_static_token = 5; // Indicates if a static token is configured (token value not returned for security)
}



message LoginMcpServerRequest {
    string uuid = 1;
}

message McpServerLoginUrl {
    string login_url = 1;
}
