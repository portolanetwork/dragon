turnstile {
  grpc {
    host = "0.0.0.0"
    port = 8080
  }

  cluster {
    num-shards = 24
  }

  mcp {
    enabled = false
    name = "Turnstile MCP Server"
    version = "1.0.0"
    host = "0.0.0.0"
    port = 8081
  }

  mcp-stdio {
    enabled = true
    name = "Turnstile MCP Stdio Server"
    version = "1.0.0"
  }

  mcp-streaming {
    enabled = true
    name = "Turnstile MCP Streaming Server"
    version = "1.0.0"
    host = "0.0.0.0"
    port = 8082
  }
}

pekko {
  loglevel = DEBUG

  http.server.preview.enable-http2 = on

  http {
    server {
      idle-timeout = 600s
    }
  }

  actor {
    provider = cluster

    allow-java-serialization = on

    serialization-bindings {
      "java.lang.String" = java
      "com.google.protobuf.Message" = proto
      "app.dragon.turnstile.actor.TurnstileSerializable" = jackson-json
    }
  }

  remote.artery {
    canonical {
      hostname = "127.0.0.1"
      port = 25520
    }
  }

  cluster {
    seed-nodes = [
      "pekko://turnstile@127.0.0.1:25520"
    ]

    sharding {
      number-of-shards = 100

      passivation {
        strategy = default-strategy
        default-strategy {
          active-entity-limit = 1000000
        }
      }
    }

    downing-provider-class = "org.apache.pekko.cluster.sbr.SplitBrainResolverProvider"
  }

  management {
    http {
      hostname = "127.0.0.1"
      port = 8558
    }

    cluster.bootstrap {
      contact-point-discovery {
        service-name = "turnstile"
        discovery-method = config
      }
      contact-point {
        required-contact-point-nr = 1
      }
    }
  }

  discovery {
    method = config
    config.services {
      turnstile {
        endpoints = [
          {
            host = "127.0.0.1"
            port = 8558
          }
        ]
      }
    }
  }
}
